<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LM3-PPA usage • rsofun</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- Fonts --><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Titillium+Web:ital,wght@0,300;0,400;0,700;1,300;1,400&amp;display=swap" rel="stylesheet">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- ropensci --><link href="../ceslabs.css" rel="stylesheet">
<meta property="og:title" content="LM3-PPA usage">
<meta property="og:description" content="rsofun">
<meta name="twitter:card" content="summary">
<!-- Mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js" async integrity="sha256-nlrDrBTHxJJlDDX22AS33xYI1OJHnGMDhiYMSe2U0e0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/config/TeX-AMS-MML_HTMLorMML.js" async integrity="sha256-4zys9A4hMQmtq2EUL+JRoXc0NZi8jVJMzb8onewOaSQ=" crossorigin="anonymous"></script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">

    <div class="navbar-header">

      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="external-link hidden-sm hidden-xs" href="https://computationales.ethz.ch/">
          <img src="https://raw.githubusercontent.com/computationales/CES_template/main/ces_logo.png" id="hexlogo" alt="bluegreen labs"></a>
        <a class="external-link hidden-md hidden-lg" href="https://computationales.ethz.ch/">
          <img src="https://raw.githubusercontent.com/computationales/CES_template/main/ces_logo.png" id="hexlogo" alt="bluegreen labs"></a>
        <a class="navbar-brand" href="../index.html">
           <i>rsofun <small>v4.3</small></i>
        </a>
      </div>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lm3ppa_model_structure.html">LM3PPA model structure</a>
    </li>
    <li>
      <a href="../articles/lm3ppa_use.html">LM3-PPA usage</a>
    </li>
    <li>
      <a href="../articles/pmodel_use.html">P-model usage</a>
    </li>
    <li>
      <a href="../articles/prepare_forcing.html">Prepare forcing</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/computationales/rsofun/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>LM3-PPA usage</h1>
                        <h4 data-toc-skip class="author">Koen
Hufkens</h4>
            
<<<<<<< HEAD
            <h4 class="date">2021-11-22</h4>
=======
>>>>>>> master
      
      <small class="dont-index">Source: <a href="https://github.com/computationales/rsofun/blob/HEAD/vignettes/lm3ppa_use.Rmd" class="external-link"><code>vignettes/lm3ppa_use.Rmd</code></a></small>
      <div class="hidden name"><code>lm3ppa_use.Rmd</code></div>

    </div>

    
    
<p>The <code>rsofun</code> package and framework includes two main
models. The <code>pmodel</code> and <code>lm3-ppa</code> (which in part
relies on pmodel component). Here we give a short example on how to run
the <code>lm3ppa</code> model on the included demo datasets to
familiarize yourself with both the data structure and the outputs.</p>
<div class="section level3">
<h3 id="demo-data">Demo data<a class="anchor" aria-label="anchor" href="#demo-data"></a>
</h3>
<p>The package includes two demo datasets to run and validate pmodel
output. These files can be directly loaded into your workspace by
typing:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/computationales/rsofun" class="external-link">rsofun</a></span><span class="op">)</span>

<span class="va">lm3ppa_gs_leuning_drivers</span>
<span class="va">lm3ppa_p_model_drivers</span>
<span class="va">lm3ppa_validation</span></code></pre></div>
<p>These are real data from the Swiss CH-Lae fluxnet site. We can use
these data to run the model, together with observations of GPP we can
also parameterize <code>lm3ppa</code> parameters.</p>
</div>
<div class="section level2">
<h2 id="two-model-approaches">Two model approaches<a class="anchor" aria-label="anchor" href="#two-model-approaches"></a>
</h2>
<p>The LM3-PPA is a cohort-based vegetation model which simulates
vegetation dynamics and biogeochemical processes (Weng et al., 2015).
The model is able to link photosynthesis standard models (Farquhar et
al., 1980) with tree allometry. In our formulation we retain the
original model structure with the standard photosynthesis formulation
(i.e. “gs_leuning”) as well as an alternative “p-model” approach. Both
model structures operate at different time scales, where the original
input has an hourly time step our alternative p-model approach uses a
daily time step. Hence, we have two different datasets as driver data
(with the lm3ppa p-model input being an aggregate of the high resolution
hourly data).</p>
<div class="section level3">
<h3 id="running-the-lm3-ppa-model-with-standard-photosynthesis">Running the LM3-PPA model with standard photosynthesis<a class="anchor" aria-label="anchor" href="#running-the-lm3-ppa-model-with-standard-photosynthesis"></a>
</h3>
<p>With all data prepared we can run the model using
<code><a href="../reference/runread_lm3ppa_f.html">runread_lm3ppa_f()</a></code>. This function takes the nested data
structure and runs the model site by site, returning nested model output
results matching the input drivers. In our case only one site will be
evaluated.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># print parameter settings</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lm3ppa_gs_leuning_drivers</span><span class="op">$</span><span class="va">params_siml</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 12</span></span>
<span class="co">#&gt;   spinup spinupyears recycle firstyeartrend nyeartrend outputhourly outputdaily</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> TRUE           250       1           <span style="text-decoration: underline;">2</span>009          1 TRUE         TRUE       </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 5 more variables: do_U_shaped_mortality &lt;lgl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   update_annualLAImax &lt;lgl&gt;, do_closedN_run &lt;lgl&gt;, method_photosynth &lt;chr&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   method_mortality &lt;chr&gt;</span></span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">lm3ppa_gs_leuning_drivers</span><span class="op">$</span><span class="va">forcing</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 8,760 × 18</span></span>
<span class="co">#&gt;    date        year   doy  hour   temp temp_soil      prec snow  vpd      rh</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2009-01-01  <span style="text-decoration: underline;">2</span>009     1     0 0.728       3.16 0.000<span style="text-decoration: underline;">018</span>4 <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     91.6</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2009-01-01  <span style="text-decoration: underline;">2</span>009     1     1 0.780       3.20 0.000<span style="text-decoration: underline;">011</span>6 <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     91.5</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2009-01-01  <span style="text-decoration: underline;">2</span>009     1     2 0.519       3.23 0.000<span style="text-decoration: underline;">011</span>6 <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     93.2</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2009-01-01  <span style="text-decoration: underline;">2</span>009     1     3 0.476       3.28 0.000<span style="text-decoration: underline;">011</span>6 <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     92.5</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2009-01-01  <span style="text-decoration: underline;">2</span>009     1     4 0.336       3.30 0.000<span style="text-decoration: underline;">014</span>0 <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     92.9</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2009-01-01  <span style="text-decoration: underline;">2</span>009     1     5 0.278       3.30 0.000<span style="text-decoration: underline;">014</span>0 <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     93.8</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2009-01-01  <span style="text-decoration: underline;">2</span>009     1     6 0.096<span style="text-decoration: underline;">6</span>      3.28 0.000<span style="text-decoration: underline;">014</span>0 <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     95.4</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2009-01-01  <span style="text-decoration: underline;">2</span>009     1     7 0.172       3.30 0.000<span style="text-decoration: underline;">021</span>1 <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     95.4</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2009-01-01  <span style="text-decoration: underline;">2</span>009     1     8 0.236       3.33 0.000<span style="text-decoration: underline;">021</span>1 <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     95.2</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2009-01-01  <span style="text-decoration: underline;">2</span>009     1     9 0.152       3.41 0.000<span style="text-decoration: underline;">021</span>1 <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     96.1</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 8,750 more rows, and 8 more variables: ppfd &lt;dbl&gt;, par &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   patm &lt;dbl&gt;, wind &lt;dbl&gt;, ccov_int &lt;lgl&gt;, ccov &lt;lgl&gt;, co2 &lt;dbl&gt;, swc &lt;dbl&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># run the model</span>
<span class="va">lm3ppa_gs_leuning_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runread_lm3ppa_f.html">runread_lm3ppa_f</a></span><span class="op">(</span>
     <span class="va">lm3ppa_gs_leuning_drivers</span>,
     makecheck <span class="op">=</span> <span class="cn">TRUE</span>,
     parallel <span class="op">=</span> <span class="cn">FALSE</span>
     <span class="op">)</span>

<span class="co"># split out the annual data</span>
<span class="va">lm3ppa_gs_leuning_output</span> <span class="op">&lt;-</span> <span class="va">lm3ppa_gs_leuning_output</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">output_annual_tile</span></code></pre></div>
<div class="section level4">
<h4 id="plotting-output">Plotting output<a class="anchor" aria-label="anchor" href="#plotting-output"></a>
</h4>
<p>We can now visualize the model output.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># we only have one site so we'll unnest</span>
<span class="co"># the main model output</span>

<<<<<<< HEAD
<span class="va">df_output</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">output_annual_tile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">GPP</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year"</span>, y <span class="op">=</span> <span class="st">"GPP"</span><span class="op">)</span></code></pre></div>
<p><img src="lm3ppa_use_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">df_output</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">output_annual_tile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">plantC</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year"</span>, y <span class="op">=</span> <span class="st">"plantC"</span><span class="op">)</span></code></pre></div>
<p><img src="lm3ppa_use_files/figure-html/unnamed-chunk-3-2.png" width="700"></p>
=======
<span class="va">lm3ppa_gs_leuning_output</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">GPP</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year"</span>, y <span class="op">=</span> <span class="st">"GPP"</span><span class="op">)</span></code></pre></div>
<p><img src="lm3ppa_use_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">lm3ppa_gs_leuning_output</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">plantC</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year"</span>, y <span class="op">=</span> <span class="st">"plantC"</span><span class="op">)</span></code></pre></div>
<p><img src="lm3ppa_use_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
>>>>>>> master
</div>
</div>
<div class="section level3">
<h3 id="running-the-lm3-ppa-model-with-p-model-photosynthesis">Running the LM3-PPA model with P-model photosynthesis<a class="anchor" aria-label="anchor" href="#running-the-lm3-ppa-model-with-p-model-photosynthesis"></a>
</h3>
<p>Running the fast P-model implementation.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># print parameter settings</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lm3ppa_p_model_drivers</span><span class="op">$</span><span class="va">params_siml</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 12</span></span>
<span class="co">#&gt;   spinup spinupyears recycle firstyeartrend nyeartrend outputhourly outputdaily</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> TRUE           250       1           <span style="text-decoration: underline;">2</span>009          1 TRUE         TRUE       </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 5 more variables: do_U_shaped_mortality &lt;lgl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   update_annualLAImax &lt;lgl&gt;, do_closedN_run &lt;lgl&gt;, method_photosynth &lt;chr&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   method_mortality &lt;chr&gt;</span></span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">lm3ppa_p_model_drivers</span><span class="op">$</span><span class="va">forcing</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 365 × 18</span></span>
<span class="co">#&gt;    date        year   doy  hour    temp temp_soil       prec snow  vpd      rh</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2009-01-01  <span style="text-decoration: underline;">2</span>009     1  11.5  0.384       3.39 0.000<span style="text-decoration: underline;">016</span>6  <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     93.7</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2009-01-02  <span style="text-decoration: underline;">2</span>009     2  11.5 -<span style="color: #BB0000;">1.64</span>        2.55 0.000<span style="text-decoration: underline;">023</span>2  <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     92.5</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2009-01-03  <span style="text-decoration: underline;">2</span>009     3  11.5 -<span style="color: #BB0000;">2.51</span>        1.95 0.000<span style="text-decoration: underline;">003</span>71 <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     85.1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2009-01-04  <span style="text-decoration: underline;">2</span>009     4  11.5 -<span style="color: #BB0000;">1.82</span>        2.20 0.000<span style="text-decoration: underline;">013</span>0  <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     83.5</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2009-01-05  <span style="text-decoration: underline;">2</span>009     5  11.5 -<span style="color: #BB0000;">1.34</span>        2.23 0.000<span style="text-decoration: underline;">022</span>3  <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     87.8</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2009-01-06  <span style="text-decoration: underline;">2</span>009     6  11.5 -<span style="color: #BB0000;">0.450</span>       2.75 0.000<span style="text-decoration: underline;">021</span>9  <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     90.9</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2009-01-07  <span style="text-decoration: underline;">2</span>009     7  11.5  0.266       3.50 0.000<span style="text-decoration: underline;">013</span>6  <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     89.7</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2009-01-08  <span style="text-decoration: underline;">2</span>009     8  11.5  0.504       3.52 0.000<span style="text-decoration: underline;">011</span>3  <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     86.1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2009-01-09  <span style="text-decoration: underline;">2</span>009     9  11.5  0.086<span style="text-decoration: underline;">9</span>      3.49 0.000<span style="text-decoration: underline;">018</span>6  <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     90.3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2009-01-10  <span style="text-decoration: underline;">2</span>009    10  11.5 -<span style="color: #BB0000;">0.404</span>       3.44 0.000<span style="text-decoration: underline;">012</span>5  <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     90.1</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 355 more rows, and 8 more variables: ppfd &lt;dbl&gt;, par &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   patm &lt;dbl&gt;, wind &lt;dbl&gt;, ccov_int &lt;lgl&gt;, ccov &lt;lgl&gt;, co2 &lt;dbl&gt;, swc &lt;dbl&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># run the model</span>
<span class="va">lm3ppa_p_model_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runread_lm3ppa_f.html">runread_lm3ppa_f</a></span><span class="op">(</span>
     <span class="va">lm3ppa_p_model_drivers</span>,
     makecheck <span class="op">=</span> <span class="cn">TRUE</span>,
     parallel <span class="op">=</span> <span class="cn">FALSE</span>
     <span class="op">)</span>

<span class="co"># split out the annual data for visuals</span>
<span class="va">lm3ppa_p_model_output</span> <span class="op">&lt;-</span> <span class="va">lm3ppa_p_model_output</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">output_annual_tile</span></code></pre></div>
<div class="section level4">
<h4 id="plotting-output-1">Plotting output<a class="anchor" aria-label="anchor" href="#plotting-output-1"></a>
</h4>
<p>We can now visualize the model output.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># we only have one site so we'll unnest</span>
<span class="co"># the main model output</span>

<<<<<<< HEAD
<span class="va">df_output</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">output_annual_tile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">GPP</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year"</span>, y <span class="op">=</span> <span class="st">"GPP"</span><span class="op">)</span></code></pre></div>
<p><img src="lm3ppa_use_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">df_output</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">output_annual_tile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">plantC</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year"</span>, y <span class="op">=</span> <span class="st">"plantC"</span><span class="op">)</span></code></pre></div>
<p><img src="lm3ppa_use_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
=======
<span class="va">lm3ppa_p_model_output</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">GPP</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year"</span>, y <span class="op">=</span> <span class="st">"GPP"</span><span class="op">)</span></code></pre></div>
<p><img src="lm3ppa_use_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">lm3ppa_p_model_output</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">plantC</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year"</span>, y <span class="op">=</span> <span class="st">"plantC"</span><span class="op">)</span></code></pre></div>
<p><img src="lm3ppa_use_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
>>>>>>> master
</div>
</div>
<<<<<<< HEAD
<div id="calibrating-model-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#calibrating-model-parameters" class="anchor"></a>Calibrating model parameters</h2>
<p>To optimize new parameters based upon driver data and a validation dataset we must first specify an optimization strategy and settings, as well as parameter ranges.</p>
<<<<<<< HEAD
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>lm3ppa_gs_leuning_drivers<span class="sc">$</span>params_siml[[<span class="dv">1</span>]]<span class="sc">$</span>spinup <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>lm3ppa_gs_leuning_drivers<span class="sc">$</span>params_siml[[<span class="dv">1</span>]]<span class="sc">$</span>spinupyears <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mortality as DBH</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>settings <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method              =</span> <span class="st">"bayesiantools"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">targetvars          =</span> <span class="fu">c</span>(<span class="st">"gpp"</span>),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">timescale           =</span> <span class="fu">list</span>(<span class="at">targets_obs =</span> <span class="st">"y"</span>),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">sitenames           =</span> <span class="st">"CH-Lae"</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric              =</span> cost_rmse_lm3ppa_gsleuning,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">dir_results         =</span> <span class="st">"./"</span>,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">name                =</span> <span class="st">"ORG"</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">sampler =</span> <span class="st">"DEzs"</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">settings =</span> <span class="fu">list</span>(</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">burnin =</span> <span class="dv">10</span>,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">iterations =</span> <span class="dv">50</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">par =</span> <span class="fu">list</span>(</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">phiRL =</span> <span class="fu">list</span>(<span class="at">lower=</span><span class="fl">0.5</span>, <span class="at">upper=</span><span class="dv">5</span>, <span class="at">init=</span><span class="fl">3.5</span>),</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">LAI_light =</span> <span class="fu">list</span>(<span class="at">lower=</span><span class="dv">2</span>, <span class="at">upper=</span><span class="dv">5</span>, <span class="at">init=</span><span class="fl">3.5</span>),</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">tf_base =</span> <span class="fu">list</span>(<span class="at">lower=</span><span class="fl">0.5</span>, <span class="at">upper=</span><span class="fl">1.5</span>, <span class="at">init=</span><span class="dv">1</span>),</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">par_mort =</span> <span class="fu">list</span>(<span class="at">lower=</span><span class="fl">0.1</span>, <span class="at">upper=</span><span class="dv">2</span>, <span class="at">init=</span><span class="dv">1</span>))</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">calib_sofun</span>(</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">drivers =</span> lm3ppa_gs_leuning_drivers,</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">obs =</span> lm3ppa_validation_2,</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">settings =</span> settings</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a> Running DEzs<span class="sc">-</span>MCMC, chain  <span class="dv">1</span> iteration <span class="dv">51</span> of <span class="dv">51</span> . Current logp  <span class="fl">6.755456</span> <span class="fl">6.755456</span> <span class="fl">6.755456</span> . Please wait<span class="sc">!</span> </span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; runMCMC terminated after 2.27seconds</span></span></code></pre></div>
=======
=======
<div class="section level3">
<h3 id="calibrating-model-parameters">Calibrating model parameters<a class="anchor" aria-label="anchor" href="#calibrating-model-parameters"></a>
</h3>
<p>To optimize new parameters based upon driver data and a validation
dataset we must first specify an optimization strategy and settings, as
well as parameter ranges.</p>
>>>>>>> master
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Mortality as DBH</span>
<span class="va">settings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  method              <span class="op">=</span> <span class="st">"bayesiantools"</span>,
  targetvars          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gpp"</span><span class="op">)</span>,
  timescale           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>targets_obs <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span>,
  sitenames           <span class="op">=</span> <span class="st">"CH-Lae"</span>,
  metric              <span class="op">=</span> <span class="va">cost_rmse_lm3ppa_gsleuning</span>,
  dir_results         <span class="op">=</span> <span class="st">"./"</span>,
  name                <span class="op">=</span> <span class="st">"ORG"</span>,
  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    sampler <span class="op">=</span> <span class="st">"DEzs"</span>,
    settings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
      burnin <span class="op">=</span> <span class="fl">10</span>,
      iterations <span class="op">=</span> <span class="fl">50</span>
    <span class="op">)</span>
  <span class="op">)</span>,
  par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
       phiRL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lower<span class="op">=</span><span class="fl">0.5</span>, upper<span class="op">=</span><span class="fl">5</span>, init<span class="op">=</span><span class="fl">3.5</span><span class="op">)</span>,
      LAI_light <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lower<span class="op">=</span><span class="fl">2</span>, upper<span class="op">=</span><span class="fl">5</span>, init<span class="op">=</span><span class="fl">3.5</span><span class="op">)</span>,
      tf_base <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lower<span class="op">=</span><span class="fl">0.5</span>, upper<span class="op">=</span><span class="fl">1.5</span>, init<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,
      par_mort <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lower<span class="op">=</span><span class="fl">0.1</span>, upper<span class="op">=</span><span class="fl">2</span>, init<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calib_sofun.html">calib_sofun</a></span><span class="op">(</span>
  drivers <span class="op">=</span> <span class="va">lm3ppa_gs_leuning_drivers</span>,
  obs <span class="op">=</span> <span class="va">lm3ppa_validation_2</span>,
  settings <span class="op">=</span> <span class="va">settings</span>
<span class="op">)</span></code></pre></div>
>>>>>>> master
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start bottom-8">
            <div class="col-xs-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/computationales" target="_blank" class="external-link">
                          <div class="icon fab fa-github"></div></a>
                        <a href="https://computationales.ethz.ch/" target="_blank" class="external-link">
                          <div class="icon fa fa-flask"></div></a>
                        <a href="http://twitter.com/stineb/" target="_blank" class="external-link">
                          <div class="icon fab fa-twitter"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://computationales.ethz.ch/" class="external-link">Computationales</a></li>
                            <li><a href="https://computationales.ethz.ch/" class="external-link">Our Team</a></li>
                            <li><a href="https://computationales.ethz.ch/" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://github.com/computationales" class="external-link">Packages</a></li>
                            <li><a href="https://computationales.ethz.ch/" class="external-link">Publications</a></li>
                            <li><a href="https://computationales.ethz.ch/" class="external-link">Blog</a></li>
                        </ul>
</div>

                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->

      </footer>
</div>

  


  

  </body>
</html>
